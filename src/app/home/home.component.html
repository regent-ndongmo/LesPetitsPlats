<div class="container">
  <header class="my-4  text-center">
    <img src="assets/logo.png" alt="Les petits plats" class="logo">
  </header>
  <div class="input-group mb-3" (focusin)="onFocus()" (focusout)="onBlur()">
    <input type="text" class="form-control" placeholder="Rechercher titre, ingrÃ©dients ou description."
           [(ngModel)]="searchQuery" (input)="onSearch($event)">
    <div class="input-group-append">
      <button class="btn btn-outline-secondary" type="button"><i class="fas fa-search"></i></button>
    </div>
  </div>

  <div class="position-relative">
    <ul class="list-group position-absolute w-100" *ngIf="filteredResults.length > 0 && showSuggestions">
      @for (result of filteredResults; track $index) {
        <li class="list-group-item list-group-item-action" (click)="selectResult(result)">
          {{ result.name }}
        </li>
        <li class="list-group-item list-group-item-action" (click)="selectResult(result)">
          {{ result.ingredient }}
        </li>
        <li class="list-group-item list-group-item-action" (click)="selectResult(result)">
          {{ result.description }}
        </li>
      }

    </ul>
  </div>


    <!--  -->
  @if (selected) {
    <div class="mt-4 mb-4">
      <div class="btn-custom">
        <span class="btn-label">{{ selected }}</span>
        <span class="">
          <i class="fas fa-times m-1" (click)="ngOnInit()"></i>
        </span>
      </div>
    </div>
  }



  <div class="d-flex mb-4">
    <!-- Dropdown Ingredients -->
    <div class="btn-group mr-2">
      <button type="button" class="btn btn-purple" (click)="toggleDropdown('ingredients')" data-bs-toggle="dropdown" aria-expanded="false">
        Ingredients <i class="fas" [ngClass]="{'fa-angle-down': !dropdowns.ingredients, 'fa-angle-up': dropdowns.ingredients}"></i>
      </button>
      <ul class="dropdown-menu" [class.show]="dropdowns.ingredients" style="max-height: 200px; overflow-y: auto;">
        @for (item of ingredientList; track $index) {
          <li><a class="dropdown-item" (click)="searchIngredient(item)">{{ item }}</a></li>
        }
      </ul>
    </div>

    <!-- Dropdown Appareils -->
    <div class="btn-group mr-2">
      <button type="button" class="btn btn-green" (click)="toggleDropdown('appareils')" data-bs-toggle="dropdown" aria-expanded="false">
        Appareils <i class="fas" [ngClass]="{'fa-angle-down': !dropdowns.appareils, 'fa-angle-up': dropdowns.appareils}"></i>
      </button>
      <ul class="dropdown-menu" [class.show]="dropdowns.appareils" style="max-height: 200px; overflow-y: auto;">
        @for (item of appareilList; track $index) {
          <li><a class="dropdown-item" (click)="searchAppareil(item.appliance)">{{ item.appliance }}</a></li>
        }
        </ul>
    </div>

    <!-- Dropdown Ustensiles -->
    <div class="btn-group mr-2">
      <button type="button" class="btn btn-red" (click)="toggleDropdown('ustensiles')" data-bs-toggle="dropdown" aria-expanded="false">
        Ustensiles <i class="fas" [ngClass]="{'fa-angle-down': !dropdowns.ustensiles, 'fa-angle-up': dropdowns.ustensiles}"></i>
      </button>
      <ul class="dropdown-menu" [class.show]="dropdowns.ustensiles" style="max-height: 200px; overflow-y: auto;">
        @for (item of data; track $index) {
          @for (itemU of item.ustensils; track $index) {
            <li><a class="dropdown-item" (click)="searchUstensils(itemU)">{{ itemU }}</a></li>
          }

        }
      </ul>
    </div>
  </div>

  <div class="row">
    <!-- Card 1 -->
     @for (item of data; track $index) {
      <div class="col-md-4 mb-4">
        <div class="card">
          <div class="card-img-top"></div>
          <div class="card-body">
            <div class="card-body-title mb-3">
              <h5 class="card-title">{{ item.name }}</h5>
              <div class="recipe-time"><i class="far fa-clock"></i> {{ item.time }} min</div>
            </div>
            <div class="card-text-content card-body-title">
              <p class="card-text">
                @for (ingredient of item.ingredients; track $index) {
                  <strong>{{ ingredient.ingredient }}:</strong> {{ ingredient.quantity }}{{ ingredient.unit }}<br>
                }
              </p>
              <p class="card-text" style="max-height: 90px; overflow-y: auto; max-width: 40%;">{{ item.description }}</p>
            </div>
          </div>
        </div>
      </div>
     }

  </div>
</div>


